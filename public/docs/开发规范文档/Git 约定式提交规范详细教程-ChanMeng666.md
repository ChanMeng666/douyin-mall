# Git 约定式提交规范详细教程

## 一、什么是约定式提交

约定式提交（Conventional Commits）是一种用于给提交信息增加人机可读含义的规范。它提供了一组简单规则来创建清晰的提交历史，使得项目更容易维护。

## 二、基本格式

一个标准的提交信息包含以下结构：

```
<类型>[可选的作用域]: <描述>

[可选的正文]

[可选的脚注]
```

其中：
- `<类型>`：表明你所做更改的类型
- `[可选的作用域]`：表明更改影响的范围
- `<描述>`：对更改的简短描述
- `[可选的正文]`：详细的更改说明
- `[可选的脚注]`：放置重大更改说明或问题引用

## 三、提交类型详解

### 1. feat（新功能）
用于添加新功能时使用。

示例：
```
feat(login): 添加用户登录功能

- 实现手机号登录
- 添加短信验证码功能
- 集成微信登录API

相关任务: #123
```

### 2. fix（修复）
用于修复 bug 时使用。

示例：
```
fix(database): 修复用户数据查询超时问题

将数据库连接超时时间从5秒调整为30秒，解决了在高峰期用户数据查询失败的问题。

修复: #234
```

### 3. docs（文档）
用于文档更新时使用。

示例：
```
docs(api): 更新API使用文档

- 添加新接口的使用说明
- 更新接口参数说明
- 添加调用示例代码
```

### 4. style（格式）
用于不影响代码功能的变动，如格式调整、空格、分号等。

示例：
```
style(components): 规范代码缩进和空行

- 统一使用2空格缩进
- 调整括号换行规则
- 删除多余空行
```

### 5. refactor（重构）
用于代码重构时使用，既不是新增功能，也不是修改 bug 的代码变动。

示例：
```
refactor(utils): 重构日期处理工具类

将所有日期处理相关的函数整合到 DateUtils 类中，提高代码复用性和可维护性。
```

### 6. perf（性能）
用于性能优化时使用。

示例：
```
perf(images): 优化图片加载性能

- 实现图片懒加载
- 压缩图片大小
- 添加图片缓存机制

性能提升约50%
```

### 7. test（测试）
用于添加或修改测试用例时使用。

示例：
```
test(auth): 添加登录模块单元测试

- 添加账号密码登录测试用例
- 添加验证码验证测试用例
- 添加登录失败场景测试
```

### 8. chore（构建）
用于对构建过程或辅助工具和库的更改。

示例：
```
chore(deps): 更新项目依赖版本

将 React 升级到 18.0.0
更新其他依赖到最新稳定版
```

## 四、作用域说明

作用域用于说明提交影响的范围，建议使用项目模块名称。

常见作用域示例：
- `ui`：界面相关
- `api`：接口相关
- `auth`：认证相关
- `database`：数据库相关
- `utils`：工具类相关

## 五、编写技巧

### 1. 标题编写要求
- 长度不超过50个字符
- 以动词开头（添加、修复、更新等）
- 简单明了，说明本次提交的主要内容
- 不要使用句号结尾

### 2. 正文编写要求
- 使用空行将标题与正文分隔
- 正文每行长度不超过72个字符
- 说明代码变动的动机，以及与以前行为的对比
- 使用符号列表来罗列具体变动

### 3. 脚注格式要求
主要用于放置以下内容：
- Breaking Changes（重大变更）
- 关闭 issue（例如：`Closes #123, #245`）
- 其他引用

## 六、特殊情况处理

### 1. 重大更改
当有重大更改时，需要在脚注中说明：

```
feat(api): 重构用户认证接口

将用户认证方式从JWT改为Session机制

BREAKING CHANGE: 用户认证接口的调用方式发生变化，需要在请求头中使用新的认证格式
```

### 2. 多个类型
当一次提交涉及多个类型时，优先使用影响范围较大的类型：

```
feat(user): 添加用户资料编辑功能并修复若干问题

- 新增用户头像上传功能
- 修复用户名无法修改的bug
- 优化表单提交性能
```

## 七、提交示例

### 1. 新功能开发
```
feat(order): 实现订单导出功能

- 添加订单导出为Excel功能
- 支持自定义导出字段
- 添加导出进度提示

涉及文件：
- src/services/order.js
- src/components/OrderExport.vue
- src/utils/excel.js

相关任务: #432
```

### 2. 问题修复
```
fix(cart): 修复购物车商品数量无法更新的问题

问题描述：
点击增加/减少按钮时，商品数量显示未更新

解决方案：
修复商品数量计算逻辑，添加数据更新后的界面刷新

修复: #345
```

### 3. 代码优化
```
refactor(common): 优化公共组件结构

- 将重复的代码提取为独立组件
- 优化组件参数传递方式
- 统一错误处理逻辑

影响范围：
- src/components/common/*
- src/utils/error.js
```

## 八、常见错误示例

### 1. 错误的提交信息
```
# ❌ 错误示例
更新代码
修复bug
样式调整
```

### 2. 正确的提交信息
```
# ✅ 正确示例
feat(home): 添加首页轮播图组件
fix(login): 修复登录按钮点击无反应的问题
style(global): 统一按钮样式规范
```

## 九、实用工具推荐

1. **commitlint**: 用于检查提交信息是否符合规范
2. **commitizen**: 提供交互式命令行工具，帮助生成规范的提交信息
3. **conventional-changelog**: 根据提交信息自动生成更新日志

## 十、使用建议

1. 在开始新项目时就制定提交规范
2. 配置 git hook 来强制检查提交信息
3. 定期review提交历史，及时纠正不规范的提交
4. 通过团队内部培训，确保所有成员理解并遵循规范

